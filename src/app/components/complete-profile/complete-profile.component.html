<div class="min-h-screen bg-gradient-to-br from-sky-50 via-white to-sky-100 py-8 px-6">
    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50">
        <div class="text-center">
            <div class="inline-block animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-sky-700"></div>
            <p class="mt-4 text-gray-700 font-medium">Loading your profile...</p>
        </div>
    </div>

    <!-- Main Content (hidden while loading) -->
    <div *ngIf="!isLoading" class="max-w-full mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <div
                class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-sky-700 to-sky-950 rounded-full mb-4 shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-white" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </div>
            <h1 class="text-3xl font-bold text-gray-900 mb-2">Complete Your Profile</h1>
            <p class="text-gray-600">Step {{ currentStep }} of 2</p>
        </div>

        <!-- Progress Bar -->
        <div class="max-w-2xl mx-auto mb-8">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-medium" [class.text-sky-700]="currentStep >= 1"
                    [class.text-gray-400]="currentStep < 1">
                    Personal Info
                </span>
                <span class="text-sm font-medium" [class.text-sky-700]="currentStep >= 2"
                    [class.text-gray-400]="currentStep < 2">
                    Set Password
                </span>
            </div>
            <div class="relative h-2 bg-gray-200 rounded-full overflow-hidden">
                <div class="absolute h-full bg-gradient-to-r from-sky-700 to-sky-950 transition-all duration-500 ease-out"
                    [style.width.%]="currentStep === 1 ? 50 : 100">
                </div>
            </div>
        </div>

        <!-- Profile Card -->
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div class="bg-gradient-to-r from-sky-700 to-sky-950 h-32"></div>

            <div class="px-8 pb-8">
                <div class="relative -mt-16 mb-6">
                    <div
                        class="inline-flex items-center justify-center w-32 h-32 bg-white rounded-full shadow-lg border-4 border-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 text-gray-400" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                </div>

                <!-- Step 1: Personal Information -->
                <div *ngIf="currentStep === 1">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

                        <!-- Left Column - Personal Information -->
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4 border-b pb-2">Personal Information</h3>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    First Name <span class="text-red-500">*</span>
                                </label>
                                <input type="text" [(ngModel)]="formData.firstName" disabled
                                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-600" />
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Middle Name
                                </label>
                                <input type="text" [(ngModel)]="formData.middleName" disabled
                                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-600" />
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Last Name <span class="text-red-500">*</span>
                                </label>
                                <input type="text" [(ngModel)]="formData.lastName" disabled
                                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-600" />
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Suffix
                                </label>
                                <input type="text" [(ngModel)]="formData.suffix" disabled placeholder="Jr., Sr., III"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-600" />
                            </div>
                        </div>

                        <!-- Right Column - Contact Information -->
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4 border-b pb-2">Contact Information</h3>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="inline w-4 h-4 mr-2"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                                        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                                    </svg>
                                    Email Address <span class="text-red-500">*</span>
                                </label>
                                <input type="email" [(ngModel)]="formData.email" [disabled]="!isEditing"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-600" />
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="inline w-4 h-4 mr-2"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path
                                            d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                                        </path>
                                    </svg>
                                    Phone Number
                                </label>
                                <input type="tel" [(ngModel)]="formData.phone" [disabled]="!isEditing"
                                    class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-600" />
                            </div>
                        </div>
                    </div>

                    <!-- Step 1 Actions -->
                    <div class="mt-8 flex gap-4">
                        <button *ngIf="!isEditing" (click)="toggleEdit()"
                            class="flex-1 bg-gradient-to-r from-sky-700 to-sky-950 text-white px-6 py-3 rounded-lg font-medium hover:from-sky-800 hover:to-black transition shadow-lg hover:shadow-xl flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path>
                                <path d="m15 5 4 4"></path>
                            </svg>
                            Edit Information
                        </button>

                        <button *ngIf="isEditing" (click)="nextStep()" [disabled]="!validateStep1()"
                            class="flex-1 bg-gradient-to-r from-sky-700 to-sky-950 text-white px-6 py-3 rounded-lg font-medium hover:from-sky-800 hover:to-black transition shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                            Next Step
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M5 12h14"></path>
                                <path d="m12 5 7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Password Setup -->
                <div *ngIf="currentStep === 2">
                    <div class="max-w-2xl mx-auto space-y-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-6 border-b pb-2">Set Your Password</h3>

                        <!-- Password Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Password <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input [type]="showPassword ? 'text' : 'password'" [(ngModel)]="passwordData.password"
                                    (ngModelChange)="checkPasswordStrength()"
                                    class="w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition"
                                    placeholder="Enter your password" />
                                <button type="button" (click)="showPassword = !showPassword"
                                    class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                    <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                    <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path>
                                        <path
                                            d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68">
                                        </path>
                                        <path
                                            d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61">
                                        </path>
                                        <line x1="2" x2="22" y1="2" y2="22"></line>
                                    </svg>
                                </button>
                            </div>

                            <!-- Password Strength Indicator -->
                            <div *ngIf="passwordData.password.length > 0" class="mt-2">
                                <div class="flex items-center gap-2 mb-1">
                                    <div class="flex-1 h-2 bg-gray-200 rounded-full overflow-hidden">
                                        <div class="h-full transition-all duration-300"
                                            [class.bg-red-500]="passwordStrength.score <= 2"
                                            [class.bg-yellow-500]="passwordStrength.score > 2 && passwordStrength.score <= 4"
                                            [class.bg-green-500]="passwordStrength.score === 5"
                                            [style.width.%]="passwordStrength.score * 20">
                                        </div>
                                    </div>
                                    <span class="text-sm font-medium" [ngClass]="passwordStrength.color">
                                        {{ passwordStrength.label }}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Password Requirements -->
                        <div class="bg-gray-50 rounded-lg p-4 space-y-2">
                            <p class="text-sm font-medium text-gray-700 mb-3">Password must contain:</p>
                            <div class="space-y-2">
                                <div class="flex items-center gap-2 text-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        [class.text-green-600]="passwordRequirements.minLength"
                                        [class.text-gray-400]="!passwordRequirements.minLength" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M20 6 9 17l-5-5"></path>
                                    </svg>
                                    <span [class.text-green-600]="passwordRequirements.minLength"
                                        [class.text-gray-600]="!passwordRequirements.minLength">
                                        At least 8 characters
                                    </span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        [class.text-green-600]="passwordRequirements.hasUppercase"
                                        [class.text-gray-400]="!passwordRequirements.hasUppercase" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M20 6 9 17l-5-5"></path>
                                    </svg>
                                    <span [class.text-green-600]="passwordRequirements.hasUppercase"
                                        [class.text-gray-600]="!passwordRequirements.hasUppercase">
                                        One uppercase letter (A-Z)
                                    </span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        [class.text-green-600]="passwordRequirements.hasLowercase"
                                        [class.text-gray-400]="!passwordRequirements.hasLowercase" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M20 6 9 17l-5-5"></path>
                                    </svg>
                                    <span [class.text-green-600]="passwordRequirements.hasLowercase"
                                        [class.text-gray-600]="!passwordRequirements.hasLowercase">
                                        One lowercase letter (a-z)
                                    </span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        [class.text-green-600]="passwordRequirements.hasNumber"
                                        [class.text-gray-400]="!passwordRequirements.hasNumber" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M20 6 9 17l-5-5"></path>
                                    </svg>
                                    <span [class.text-green-600]="passwordRequirements.hasNumber"
                                        [class.text-gray-600]="!passwordRequirements.hasNumber">
                                        One number (0-9)
                                    </span>
                                </div>
                                <div class="flex items-center gap-2 text-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        [class.text-green-600]="passwordRequirements.hasSpecial"
                                        [class.text-gray-400]="!passwordRequirements.hasSpecial" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M20 6 9 17l-5-5"></path>
                                    </svg>
                                    <span [class.text-green-600]="passwordRequirements.hasSpecial"
                                        [class.text-gray-600]="!passwordRequirements.hasSpecial">
                                        One special character (!&#64;#$%^&*)
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Confirm Password Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Confirm Password <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input [type]="showConfirmPassword ? 'text' : 'password'"
                                    [(ngModel)]="passwordData.confirmPassword"
                                    class="w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-sky-600 focus:border-transparent transition"
                                    [class.border-red-500]="passwordData.confirmPassword.length > 0 && !passwordsMatch()"
                                    [class.border-green-500]="passwordsMatch()" placeholder="Confirm your password" />
                                <button type="button" (click)="showConfirmPassword = !showConfirmPassword"
                                    class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                    <svg *ngIf="!showConfirmPassword" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                    <svg *ngIf="showConfirmPassword" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path>
                                        <path
                                            d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68">
                                        </path>
                                        <path
                                            d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61">
                                        </path>
                                        <line x1="2" x2="22" y1="2" y2="22"></line>
                                    </svg>
                                </button>
                            </div>
                            <p *ngIf="passwordData.confirmPassword.length > 0 && !passwordsMatch()"
                                class="mt-2 text-sm text-red-600">
                                Passwords do not match
                            </p>
                            <p *ngIf="passwordsMatch()" class="mt-2 text-sm text-green-600 flex items-center gap-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M20 6 9 17l-5-5"></path>
                                </svg>
                                Passwords match
                            </p>
                        </div>

                        <div *ngIf="successMessage"
                            class="bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg mb-4">
                            <div class="flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M20 6 9 17l-5-5"></path>
                                </svg>
                                <span>{{ successMessage }}</span>
                            </div>
                        </div>

                        <div *ngIf="errorMessage"
                            class="bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg mb-4">
                            <div class="flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" x2="12" y1="8" y2="12"></line>
                                    <line x1="12" x2="12.01" y1="16" y2="16"></line>
                                </svg>
                                <span>{{ errorMessage }}</span>
                            </div>
                        </div>

                        <!-- Step 2 Actions -->
                        <div class="mt-8 flex gap-4">
                            <button (click)="previousStep()"
                                class="flex-1 bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-300 transition flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M19 12H5"></path>
                                    <path d="m12 19-7-7 7-7"></path>
                                </svg>
                                Back
                            </button>
                            <button (click)="submitProfile()" [disabled]="!isPasswordValid() || isSubmitting"
                                class="flex-1 bg-gradient-to-r from-sky-700 to-sky-950 text-white px-6 py-3 rounded-lg font-medium hover:from-sky-800 hover:to-black transition shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                                <svg *ngIf="!isSubmitting" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
                                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M20 6 9 17l-5-5"></path>
                                </svg>
                                <div *ngIf="isSubmitting"
                                    class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
                                {{ isSubmitting ? 'Creating Account...' : 'Complete Profile' }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>